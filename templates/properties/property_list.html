{% extends 'base.html' %}
{% load humanize %}

{% block title %}My Properties - Propz{% endblock %}

{% block content %}
<div class="dashboard container">
    <div class="dashboard-header">
        <div>
            <h1>My Properties</h1>
            <p style="color: var(--gray-500);">Manage all your rental properties</p>
        </div>
        <div class="actions">
            <a href="{% url 'property_add' %}" class="btn btn-primary">+ Add Property</a>
        </div>
    </div>

    {% if properties %}
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem;">
        {% for property in properties %}
        <a href="{% url 'property_detail' property.pk %}" style="text-decoration: none; color: inherit;">
            <div style="position: relative;">
                {% if property.photo %}
                <img src="{{ property.photo.url }}" alt="{{ property.name }}" style="width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 12px; display: block;">
                {% else %}
                <div style="width: 100%; aspect-ratio: 1/1; border-radius: 12px; background: linear-gradient(135deg, #e8ecf1 0%, #d1d5db 100%); display: flex; align-items: center; justify-content: center;">
                    <i data-lucide="home" style="width: 48px; height: 48px; color: #9ca3af;"></i>
                </div>
                {% endif %}
                <div style="position: absolute; top: 10px; right: 10px;">
                    <span style="background: rgba(0,0,0,0.6); color: {% if property.is_occupied %}#fbbf24{% else %}#4ade80{% endif %}; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">{% if property.is_occupied %}Occupied{% else %}Vacant{% endif %}</span>
                </div>
                <div style="position: absolute; top: 10px; left: 10px; display: flex; gap: 4px;">
                    <span style="background: rgba(0,0,0,0.6); color: white; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">{{ property.get_listing_type_display }}</span>
                </div>
            </div>
            <div style="padding: 0.75rem 0.25rem 0;">
                <h4 style="font-size: 1rem; font-weight: 600; margin-bottom: 2px;">{{ property.name }}</h4>
                <p style="color: var(--gray-500); font-size: 0.875rem; margin-bottom: 4px;">{{ property.address|truncatechars:40 }} · {{ property.get_state_display }}</p>
                <p style="font-weight: 700; color: var(--primary); font-size: 1rem;">₦{{ property.rent_amount|floatformat:"0"|intcomma }}{% if property.get_rent_period_display %} <span style="font-weight: 400; color: var(--gray-500); font-size: 0.85rem;">/ {{ property.get_rent_period_display }}</span>{% endif %}</p>
                <div style="display: flex; gap: 0.5rem; margin-top: 0.75rem;">
                    <span style="display: inline-block; padding: 6px 14px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 0.8rem; color: var(--gray-600);">View</span>
                    <span onclick="event.preventDefault(); window.location='{% url 'property_edit' property.pk %}';" style="display: inline-block; padding: 6px 14px; border: 1px solid var(--gray-300); border-radius: 8px; font-size: 0.8rem; color: var(--gray-600); cursor: pointer;">Edit</span>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state card">
        <div class="empty-state-icon"><i data-lucide="house" class="icon-md"></i></div>
        <h3>No Properties Yet</h3>
        <p>Add your first property to get started.</p>
        <a href="{% url 'property_add' %}" class="btn btn-primary mt-2">+ Add Property</a>
    </div>
    {% endif %}
</div>
{% endblock %}